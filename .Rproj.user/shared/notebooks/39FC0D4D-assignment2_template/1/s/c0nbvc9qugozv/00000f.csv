"0","# Create detailed tract-level map"
"0","base_tracts <- census_tracts %>% st_transform(st_crs(pa_counties))"
"0","vuln_map    <- vulnerable_tracts %>%"
"0","  st_transform(st_crs(pa_counties)) %>%"
"0","  mutate(status = ifelse(underserved, ""Underserved (>15 mi)"", ""Vulnerable (≤15 mi)""))"
"0","hosp_map    <- hospitals %>% st_transform(st_crs(pa_counties))"
"0",""
"0","#Plot"
"0","ggplot() +"
"0","  geom_sf(data = base_tracts, fill = ""#f3f3f3"", color = ""grey90"", linewidth = 0.15, show.legend = FALSE) +"
"0","  geom_sf(data = vuln_map, aes(fill = status), color = NA, alpha = 0.9) +"
"0","  geom_sf(data = pa_counties, fill = NA, color = ""white"", linewidth = 0.4) +"
"0","  geom_sf(data = hosp_map, color = ""black"", size = 0.6, alpha = 0.7, show.legend = FALSE) +"
"0","  scale_fill_manual("
"0","    values = c(""Vulnerable (≤15 mi)"" = ""#fdd0a2"","
"0","               ""Underserved (>15 mi)"" = ""#cb181d""),"
"0","    name = ""Tract categories\n(Vulnerable = median income < $50k & 65+ ≥ 20%)"","
"0","    labels = c("
"0","      ""Underserved (>15 mi)"" = ""Underserved: vulnerable & >15 mi"","
"0","      ""Vulnerable (≤15 mi)"" = ""Vulnerable: ≤15 mi"""
"0","    )"
"0","  ) +"
"0","  guides(fill = guide_legend(title.position = ""top"")) +"
"0","  labs("
"0","    title = ""Underserved Vulnerable Tracts (Tract-Level View)"","
"0","    subtitle = ""Red = vulnerable tracts >15 miles from hospitals; Orange = vulnerable tracts ≤15 miles"","
"0","    caption = ""Sources: ACS 2018–2022; Hospitals (course data)"""
"0","  ) +"
"0","  theme_void() +"
"0","  theme(legend.position = ""right"")"
