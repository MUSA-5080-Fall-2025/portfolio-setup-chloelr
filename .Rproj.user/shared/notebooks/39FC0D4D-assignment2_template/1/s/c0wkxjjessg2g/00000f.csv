"0","# Change NA to 0"
"0","county_stats <- county_stats %>%"
"0","  mutate("
"0","    pct_underserved = ifelse(is.na(pct_underserved), 0, pct_underserved)"
"0","  )"
"0",""
"0","# Create county-level access map"
"0","pa_counties_map <- pa_counties %>%"
"0","  left_join(county_stats, by = ""COUNTY_NAM"")"
"0",""
"0","# Ensure hospitals share the same CRS as the map layer"
"0","hospitals_map <- st_transform(hospitals, st_crs(pa_counties_map))"
"0",""
"0","# Choropleth: % of vulnerable tracts that are underserved; hospitals as points"
"0","# Choropleth"
"0","ggplot() +"
"0","  geom_sf(data = pa_counties_map,"
"0","          aes(fill = pct_underserved),"
"0","          color = ""white"", size = 0.3) +"
"0","  geom_sf(data = hospitals_map,"
"0","          color = ""black"", size = 0.6, alpha = 0.7, show.legend = FALSE) +"
"0","  scale_fill_gradient("
"0","    low = ""#fff5eb"", high = ""#cb181d"",                 # light → red"
"0","    limits = c(0, 100), breaks = c(0, 25, 50, 75, 100),"
"0","    labels = scales::percent_format(scale = 1),"
"0","    name = ""% of vulnerable tracts\nunderserved"""
"0","  ) +"
"0","  labs("
"0","    title = ""Healthcare Access Challenges by County"","
"0","    subtitle = ""Percent of vulnerable census tracts located > 15 miles from hospitals"","
"0","    caption = ""Source: ACS 2018–2022; Hospitals (course data). Counties with no vulnerable tracts shown as 0%."""
"0","  ) +"
"0","  theme_void()"
