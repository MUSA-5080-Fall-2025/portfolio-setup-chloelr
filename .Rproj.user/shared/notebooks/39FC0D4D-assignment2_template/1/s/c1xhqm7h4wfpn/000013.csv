"0","# Transform to appropriate projected CRS - need to do math calculations in projected"
"0","vulnerable_tracts_proj <- vulnerable_tracts %>%"
"0","  st_transform(3365)"
"0",""
"0","hospitals_proj <- hospitals %>%"
"0","  st_transform(3365)"
"0",""
"0","# Find tract centroids"
"0","tract_centroids <- st_point_on_surface(vulnerable_tracts_proj)"
"2","Warning:"
"2"," st_point_on_surface assumes attributes are constant over geometries
"
"0","# Nearest hospital for each tract"
"0","nearest_hospitals <- st_nearest_feature(tract_centroids, hospitals_proj)"
"0",""
"0","# Dist"
"0","tract_distances <- st_distance("
"0","  tract_centroids,"
"0","  hospitals_proj[nearest_hospitals, ],"
"0","  by_element = TRUE"
"0",")"
"0",""
"0","# Convert feet to miles & go back to original crs now that the math calc is done"
"0","vulnerable_tracts <- vulnerable_tracts %>%"
"0","  mutate("
"0","    dist_ft = as.numeric(tract_distances),"
"0","    dist_mi = dist_ft / 5280"
"0","  )"
"0",""
"0","avg_dist_mi <- mean(vulnerable_tracts$dist_mi, na.rm = TRUE)"
"0","max_dist_mi <- max(vulnerable_tracts$dist_mi, na.rm = TRUE)"
"0","vulnerable_over_15   <- sum(vulnerable_tracts$dist_mi > 15, na.rm = TRUE)"
"0",""
"0","summary(vulnerable_tracts$dist_mi)"
"1","    Min. "
"1"," 1st Qu. "
"1","  Median "
"1","    Mean "
"1"," 3rd Qu. "
"1","    Max. "
"1","
"
"1"," 0.03159 "
"1"," 0.99814 "
"1"," 2.01451 "
"1"," 3.59131 "
"1"," 3.87643 "
"1","18.90979 "
"1","
"
"0","vuln_dist <- vulnerable_tracts %>%"
"0","  st_drop_geometry() %>%"
"0","  dplyr::filter(!is.na(dist_mi))"
"0",""
"0","ggplot(vuln_dist, aes(x = dist_mi)) +"
"0","  geom_histogram(binwidth = 1, color = ""white"", fill = ""#9ecae1"", boundary = 0, closed = ""left"") +"
"0","  geom_vline(xintercept = 15, linetype = ""dashed"") +"
"0","  labs("
"0","    title = ""Distance to Nearest Hospital (Vulnerable Tracts)"","
"0","    x = ""Distance to nearest hospital (miles)"","
"0","    y = ""Number of vulnerable tracts"","
"0","    caption = ""Dashed line = 15-mile threshold. Most vulnerable tracts are within a few miles; the right tail reflects underserved tracts."""
"0","  ) +"
"0","  theme_minimal()"
