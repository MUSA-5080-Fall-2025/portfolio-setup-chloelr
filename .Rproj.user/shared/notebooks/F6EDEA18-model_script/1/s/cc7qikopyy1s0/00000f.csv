"0","#| message: false"
"0","#| warning: false"
"0",""
"0","# feature 3 - parks/rec sites within 0.25 mi (count)"
"0","rel_parks <- sf::st_is_within_distance(OPA_points, parksrec, dist = r_park_ft)"
"0",""
"0","OPA_points <- OPA_points %>%"
"0","  mutate(parks_cnt_0p25mi = lengths(rel_parks))"
"0",""
"0","# feature 4 - crime count within 0.5 mi (per square mile)"
"0","crime_buffer <- st_buffer(OPA_points, dist = r_crime_ft)"
"0",""
"0","rel_crime <- st_intersects(crime_buffer, crime, sparse = TRUE)"
"0",""
"0","# count number of crimes"
"0","crime_cnt <- lengths(rel_crime)"
"0",""
"0","rm(rel_crime)"
"0",""
"0","OPA_points <- OPA_points |>"
"0","  mutate("
"0","    crime_cnt_0p5mi     = crime_cnt,"
"0","    log1p_crime_cnt_0p5 = log1p(crime_cnt_0p5mi)"
"0","  )"
"0",""
"0","# feature 5 - schools within 0.5 mi (using centroids)"
"0","rel_sch <- sf::st_is_within_distance(OPA_points, schools, dist = r_school_ft)"
"0",""
"0","OPA_points <- OPA_points %>%"
"0","  mutate(schools_cnt_0p5mi = lengths(rel_sch))"
